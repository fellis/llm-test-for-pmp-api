# ABLE Core: Authoritative Knowledge Core

## Проблема

Современные AI-системы (LLM, агенты, IDE-ассистенты) имеют фундаментальный дефект:

**Они не различают гипотезу и истину.**

- LLM генерирует ответ - это гипотеза
- Memory-системы (Mem0, Graphiti) автоматически сохраняют факты - без подтверждения
- В следующей сессии агент использует эти "факты" как истину
- Ошибки накапливаются, доверие падает

### Конкретные проявления

| Ситуация | Что происходит | Последствие |
|----------|---------------|-------------|
| Архитектурное решение | LLM предлагает структуру | В следующей сессии забыто или переизобретено |
| Договорённость в чате | Обсудили подход | Через неделю никто не помнит |
| Код изменён | Файл удалён или переписан | Связанные "знания" остаются валидными |
| Конфликт информации | Два источника противоречат | Система не знает, чему верить |

---

## Почему готового решения нет

### Существующие категории и их ограничения

```
┌─────────────────────────────────────────────────────────────────┐
│                    СУЩЕСТВУЮЩИЕ РЕШЕНИЯ                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  AI Memory      │  │  Data Catalogs  │  │  PKM Systems    │ │
│  │  (Mem0, Zep)    │  │  (Atlan, etc)   │  │  (Obsidian)     │ │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤ │
│  │ ✓ Vector search │  │ ✓ Lineage       │  │ ✓ Связи         │ │
│  │ ✓ Graph store   │  │ ✓ Governance    │  │ ✓ Поиск         │ │
│  │ ✗ Human confirm │  │ ✗ Semantic      │  │ ✗ Source track  │ │
│  │ ✗ Source track  │  │ ✗ LLM integrate │  │ ✗ Lifecycle     │ │
│  │ ✗ Orphaning     │  │ ✗ Orphaning     │  │ ✗ Orphaning     │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Ontology Mgmt  │  │  Wikibase       │  │  ADR Tools      │ │
│  │  (metaphactory) │  │                 │  │                 │ │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤ │
│  │ ✓ Governance    │  │ ✓ References    │  │ ✓ Lifecycle     │ │
│  │ ✓ Provenance    │  │ ✓ Verification  │  │ ✓ Human confirm │ │
│  │ ✗ Vector search │  │ ✗ Vector search │  │ ✗ Graph         │ │
│  │ ✗ Source change │  │ ✗ Code/Git      │  │ ✗ Source track  │ │
│  │ $$$$ Enterprise │  │ Heavy stack     │  │ Only decisions  │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Ключевой разрыв

**Ни одна система не объединяет:**

1. **Human confirmation** - человек как единственный источник истины
2. **Source tracking** - отслеживание происхождения и изменений
3. **Orphaning** - автоматическая инвалидация при изменении источников
4. **Semantic search** - поиск по смыслу для recall
5. **Deterministic access** - повторяемый доступ к подтверждённым фактам

### Почему так произошло

| Причина | Объяснение |
|---------|------------|
| **Разные эпохи** | Data catalogs - из эпохи BI. PKM - из эпохи заметок. AI Memory - из эпохи агентов. Никто не строил для "LLM + человек + эволюция знаний" |
| **Разные цели** | AI Memory оптимизирует удобство агента, не корректность. Enterprise tools оптимизируют compliance, не использование |
| **Сложность** | Объединить всё = сложная система. Проще продать узкое решение |
| **Новая проблема** | LLM как часть workflow - явление 2023+. Рынок ещё не сформировался |

---

## Что такое ABLE Core

**ABLE Core** (Authoritative Believable Logic Engine) - ядро подтверждённых знаний.

### Ключевые принципы

1. **Человек - единственный authority**
   - LLM предлагает гипотезы
   - Человек подтверждает или отклоняет
   - Только подтверждённое становится знанием

2. **Знания привязаны к источникам**
   - Каждое знание имеет provenance
   - Изменение источника → пересмотр знания
   - Удаление источника → orphaned знание

3. **Детерминированный доступ к истине**
   - Один запрос = один результат (при том же состоянии)
   - Клиенты получают подтверждённые факты, не гипотезы
   - Semantic search - только для recall кандидатов

4. **Lifecycle знаний**
   - Hypothesis → Proposed → Confirmed → Active → Orphaned → Deprecated
   - Каждый переход явный и отслеживаемый

---

## Архитектура

```
┌─────────────────────────────────────────────────────────────────┐
│                         ABLE CORE                               │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │                     GRAPH LAYER                             ││
│  │         Подтверждённые сущности, связи, lifecycle           ││
│  │                                                             ││
│  │   Entity ──────── Relation ──────── Entity                  ││
│  │     │                                  │                    ││
│  │  [Active]                          [Orphaned]               ││
│  │     │                                  │                    ││
│  │  confirmed_by                     source_invalid            ││
│  │  confirmed_at                                               ││
│  └─────────────────────────────────────────────────────────────┘│
│                              ▲                                  │
│                              │ promote                          │
│  ┌───────────────────────────┴─────────────────────────────────┐│
│  │                    VECTOR LAYER                             ││
│  │           Semantic search, гипотезы, recall                 ││
│  │                                                             ││
│  │   ⚫ ⚫ ⚫ embeddings ⚫ ⚫ ⚫ similarity ⚫ ⚫ ⚫             ││
│  │                                                             ││
│  │   ТОЛЬКО для предложения кандидатов                         ││
│  │   НИКОГДА не источник истины                                ││
│  └─────────────────────────────────────────────────────────────┘│
│                              ▲                                  │
│                              │ index                            │
│  ┌───────────────────────────┴─────────────────────────────────┐│
│  │                    SEARCH LAYER                             ││
│  │          Детерминированный поиск, фильтрация                ││
│  │                                                             ││
│  │   query(snapshot_id, filters) → deterministic results       ││
│  └─────────────────────────────────────────────────────────────┘│
│                              ▲                                  │
│                              │ chunk                            │
│  ┌───────────────────────────┴─────────────────────────────────┐│
│  │                    SOURCE LAYER                             ││
│  │              Наблюдаемая реальность                         ││
│  │                                                             ││
│  │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐       ││
│  │   │   Git   │  │  Files  │  │  Chats  │  │   API   │       ││
│  │   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘       ││
│  │        │            │            │            │             ││
│  │        └────────────┴────────────┴────────────┘             ││
│  │                         │                                   ││
│  │              change events (CREATED/UPDATED/DELETED)        ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  ════════════════════════ API ══════════════════════════════   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                              │
           ┌──────────────────┼──────────────────┐
           │                  │                  │
           ▼                  ▼                  ▼
    ┌────────────┐    ┌────────────┐    ┌────────────┐
    │   Cursor   │    │  moltbot   │    │   Other    │
    │   (MCP)    │    │            │    │  clients   │
    └────────────┘    └────────────┘    └────────────┘
```

---

## Lifecycle знаний

```
                    ┌──────────────┐
                    │  HYPOTHESIS  │ ← LLM/система предложила
                    └──────┬───────┘
                           │ показать пользователю
                           ▼
                    ┌──────────────┐
                    │   PROPOSED   │ ← ждёт решения
                    └──────┬───────┘
                           │
              ┌────────────┴────────────┐
              │ confirm                 │ reject
              ▼                         ▼
       ┌──────────────┐          ┌──────────────┐
       │  CONFIRMED   │          │   REJECTED   │
       └──────┬───────┘          └──────────────┘
              │ 
              ▼
       ┌──────────────┐
       │    ACTIVE    │ ← используется клиентами
       └──────┬───────┘
              │ source изменился/удалён
              ▼
       ┌──────────────┐
       │   ORPHANED   │ ← требует пересмотра
       └──────┬───────┘
              │
    ┌─────────┴─────────┐
    │ re-confirm        │ deprecate
    ▼                   ▼
┌──────────┐     ┌──────────────┐
│  ACTIVE  │     │  DEPRECATED  │
└──────────┘     └──────────────┘
```

---

## MVP: Интеграция с Cursor

### Точки интеграции

```
┌─────────────────────────────────────────────────────────────────┐
│                      CURSOR WORKFLOW                            │
│                                                                 │
│   Пользователь                                                  │
│       │                                                         │
│       │ пишет промпт                                            │
│       ▼                                                         │
│   ┌───────────────────────────────────────┐                    │
│   │         HOOK: PRE-PROMPT              │                    │
│   │                                       │                    │
│   │  Cursor → Core: get active knowledge  │                    │
│   │  Core → Cursor: inject into context   │                    │
│   └───────────────────┬───────────────────┘                    │
│                       │                                         │
│                       ▼                                         │
│              LLM генерирует ответ                               │
│              (с учётом знаний)                                  │
│                       │                                         │
│                       ▼                                         │
│              Пользователь редактирует код                       │
│                       │                                         │
│                       ▼                                         │
│   ┌───────────────────────────────────────┐                    │
│   │         HOOK: PRE-COMMIT              │                    │
│   │                                       │                    │
│   │  Core анализирует изменения           │                    │
│   │  Core предлагает новые знания         │                    │
│   │  Пользователь подтверждает/отклоняет  │                    │
│   └───────────────────┬───────────────────┘                    │
│                       │                                         │
│                       ▼                                         │
│                    Commit                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### API для MVP

```
# Получить активные знания для контекста
GET /knowledge/active?context={repo,path}
→ [Entity, Entity, ...]

# Предложить новое знание
POST /knowledge/propose
{
  type: "ArchitectureDecision",
  content: "...",
  source: { type: "git", path: "...", revision: "..." }
}
→ { id, status: "proposed" }

# Подтвердить знание
POST /knowledge/{id}/confirm
→ { id, status: "active" }

# Отклонить знание
POST /knowledge/{id}/reject
→ { id, status: "rejected" }
```

---

## Почему это работает

| Проблема | Как решает ABLE Core |
|----------|---------------------|
| LLM забывает решения | Pre-prompt hook инжектит активные знания |
| LLM придумывает заново | Подтверждённые знания имеют приоритет |
| Знания устаревают | Source tracking + orphaning |
| Нет доверия к данным | Человек подтверждает каждое знание |
| Накопление ошибок | Lifecycle не даёт гипотезам стать истиной |

---

## Дальнейшее развитие

После MVP:

1. **Больше источников**: чаты, веб, транскрипты
2. **Больше клиентов**: moltbot, другие IDE, API
3. **Vector Layer**: semantic search для лучшего recall
4. **Multi-user**: роли, голосование, expiry подтверждений
5. **Связи между знаниями**: граф зависимостей

Концепция масштабируется горизонтально.
Ядро остаётся универсальным.
